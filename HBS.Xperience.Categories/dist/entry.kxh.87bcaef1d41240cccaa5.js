System.register(["@kentico/xperience-admin-base","@kentico/xperience-admin-components","react"],(function(e,t){var a={},r={},o={};return{setters:[function(e){a.useFormComponentCommandProvider=e.useFormComponentCommandProvider,a.usePageCommand=e.usePageCommand},function(e){r.Button=e.Button,r.ButtonColor=e.ButtonColor,r.Dialog=e.Dialog,r.FormItemWrapper=e.FormItemWrapper,r.Headline=e.Headline,r.HeadlineSize=e.HeadlineSize,r.Icon=e.Icon,r.Input=e.Input,r.TreeNode=e.TreeNode,r.TreeNodeLeadingIcon=e.TreeNodeLeadingIcon,r.TreeNodeTitle=e.TreeNodeTitle,r.TreeNodeTrailingIcon=e.TreeNodeTrailingIcon,r.TreeView=e.TreeView},function(e){o.createContext=e.createContext,o.default=e.default,o.useContext=e.useContext,o.useEffect=e.useEffect,o.useMemo=e.useMemo,o.useReducer=e.useReducer,o.useState=e.useState}],execute:function(){e((()=>{var e={459:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var r=a(81),o=a.n(r),n=a(645),l=a.n(n)()(o());l.push([e.id,".icon-clickable {\n    padding: 8px;\n    color: darkgray\n}\n    .icon-clickable.delete {\n        color: red;\n    }\n    .icon-clickable.add {\n        color: green;\n    }\n    .icon-clickable:hover {\n        opacity: 0.8;\n        background-color: darkgray;\n        color: white;\n    }\n    .icon-clickable.add:hover {\n        background-color: green;\n    }\n\n    .icon-clickable.delete:hover {\n        background-color: red;\n    }",""]);const c=l},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a="",r=void 0!==t[5];return t[4]&&(a+="@supports (".concat(t[4],") {")),t[2]&&(a+="@media ".concat(t[2]," {")),r&&(a+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),a+=e(t),r&&(a+="}"),t[2]&&(a+="}"),t[4]&&(a+="}"),a})).join("")},t.i=function(e,a,r,o,n){"string"==typeof e&&(e=[[null,e,void 0]]);var l={};if(r)for(var c=0;c<this.length;c++){var i=this[c][0];null!=i&&(l[i]=!0)}for(var s=0;s<e.length;s++){var d=[].concat(e[s]);r&&l[d[0]]||(void 0!==n&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=n),a&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=a):d[2]=a),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),t.push(d))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},379:e=>{"use strict";var t=[];function a(e){for(var a=-1,r=0;r<t.length;r++)if(t[r].identifier===e){a=r;break}return a}function r(e,r){for(var n={},l=[],c=0;c<e.length;c++){var i=e[c],s=r.base?i[0]+r.base:i[0],d=n[s]||0,g="".concat(s," ").concat(d);n[s]=d+1;var u=a(g),m={css:i[1],media:i[2],sourceMap:i[3],supports:i[4],layer:i[5]};if(-1!==u)t[u].references++,t[u].updater(m);else{var p=o(m,r);r.byIndex=c,t.splice(c,0,{identifier:g,updater:p,references:1})}l.push(g)}return l}function o(e,t){var a=t.domAPI(t);return a.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;a.update(e=t)}else a.remove()}}e.exports=function(e,o){var n=r(e=e||[],o=o||{});return function(e){e=e||[];for(var l=0;l<n.length;l++){var c=a(n[l]);t[c].references--}for(var i=r(e,o),s=0;s<n.length;s++){var d=a(n[s]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}n=i}}},569:e=>{"use strict";var t={};e.exports=function(e,a){var r=function(e){if(void 0===t[e]){var a=document.querySelector(e);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}t[e]=a}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(a)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,a)=>{"use strict";e.exports=function(e){var t=a.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(a){!function(e,t,a){var r="";a.supports&&(r+="@supports (".concat(a.supports,") {")),a.media&&(r+="@media ".concat(a.media," {"));var o=void 0!==a.layer;o&&(r+="@layer".concat(a.layer.length>0?" ".concat(a.layer):""," {")),r+=a.css,o&&(r+="}"),a.media&&(r+="}"),a.supports&&(r+="}");var n=a.sourceMap;n&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,a)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},722:(e,t,a)=>{const r=a(905).R;t.s=function(e){if(e||(e=1),!a.y.meta||!a.y.meta.url)throw console.error("__system_context__",a.y),Error("systemjs-webpack-interop was provided an unknown SystemJS context. Expected context.meta.url, but none was provided");a.p=r(a.y.meta.url,e)}},905:(e,t,a)=>{t.R=function(e,t){var a=document.createElement("a");a.href=e;for(var r="/"===a.pathname[0]?a.pathname:"/"+a.pathname,o=0,n=r.length;o!==t&&n>=0;)"/"===r[--n]&&o++;if(o!==t)throw Error("systemjs-webpack-interop: rootDirectoryLevel ("+t+") is greater than the number of directories ("+o+") in the URL path "+e);var l=r.slice(0,n+1);return a.protocol+"//"+a.host+l};Number.isInteger},952:e=>{"use strict";e.exports=a},271:e=>{"use strict";e.exports=r},954:e=>{"use strict";e.exports=o}},n={};function l(t){var a=n[t];if(void 0!==a)return a.exports;var r=n[t]={id:t,exports:{}};return e[t](r,r.exports,l),r.exports}l.y=t,l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="",l.nc=void 0;var c={};return(0,l(722).s)(1),(()=>{"use strict";l.r(c),l.d(c,{CategoryListPageTemplate:()=>N,CategorySelectContentItemTemplate:()=>P,CategorySelectPageTemplate:()=>O,CategoyListFormComponent:()=>F});var e=l(952),t=l(271),a=l(954),r=l(379),o=l.n(r),n=l(795),i=l.n(n),s=l(569),d=l.n(s),g=l(565),u=l.n(g),m=l(216),p=l.n(m),y=l(589),f=l.n(y),C=l(459),v={};v.styleTagTransform=f(),v.setAttributes=u(),v.insert=d().bind(null,"head"),v.domAPI=i(),v.insertStyleElement=p(),o()(C.Z,v),C.Z&&C.Z.locals&&C.Z.locals;const I=(e,t)=>{const{type:a,data:r}=t,o={...e};switch(a){case"categorySet":const e=o.categories.findIndex((e=>e.categoryID==r.categoryID));e>-1?o.categories[e]=r:o.categories.push(r),o.dialogOptions.currentCategory=null;break;case"categorySelect":o.dialogOptions.currentCategory=r;break;case"categoryDelete":o.categories=o.categories.filter((e=>e.categoryID!=r));break;case"setDialog":o.dialogOptions=r}return o},h={isOpen:!1,headline:"",message:""},D=(0,a.createContext)({setCurrentCategory:e=>{},setCategory:e=>{},deleteCategory:e=>{},setDialog:e=>{},dialogOptions:h,categories:[]}),E=()=>{const{setCategory:e,deleteCategory:r,dialogOptions:o,setDialog:n}=(0,a.useContext)(D),[l,c]=(0,a.useState)("");(0,a.useEffect)((()=>{c(o.currentCategory?.categoryDisplayName??"")}),[o.currentCategory]);const i=()=>{n({...o,isOpen:!1,currentCategory:null})};return a.default.createElement(t.Dialog,{isOpen:o.isOpen,headline:o.headline,onClose:i,isDismissable:!0,headerCloseButton:{tooltipText:"Close Dialog"},confirmAction:{label:"Ok",onClick:()=>{"setCategory"==o.type&&o.currentCategory?e({...o.currentCategory,categoryDisplayName:l}):"deleteCategory"==o.type&&o.currentCategory&&r(o.currentCategory.categoryID),n({...o,isOpen:!1,currentCategory:null})}},cancelAction:{label:"Cancel",onClick:i}},"setCategory"==o.type&&a.default.createElement(t.Input,{label:"Display Name",value:l,onChange:e=>c(e.currentTarget.value)}),o.message)},b=({selected:e,category:r,setSelected:o})=>{const{setDialog:n,dialogOptions:l,categories:c}=(0,a.useContext)(D);return a.default.createElement(a.default.Fragment,null,a.default.createElement(t.TreeNodeLeadingIcon,{isSelected:e,draggable:!1},a.default.createElement("span",{className:"icon-clickable add",onClick:e=>{var t;e.stopPropagation(),t={categoryDisplayName:"",categoryParentID:r.categoryID},o(!0),n({...l,currentCategory:t,isOpen:!0,type:"setCategory",headline:"Add Category",message:"Add category to parent category: "+r.categoryDisplayName})}},a.default.createElement(t.Icon,{name:"xp-plus-circle"}))),a.default.createElement(t.TreeNodeTitle,{isSelected:e},r.categoryDisplayName),a.default.createElement(t.TreeNodeTrailingIcon,null,a.default.createElement("span",{className:"icon-clickable",onClick:e=>{e.stopPropagation(),o(!0),n({...l,currentCategory:r,isOpen:!0,type:"setCategory",headline:"Update Category",message:""})}},a.default.createElement(t.Icon,{name:"xp-edit"}))),a.default.createElement(t.TreeNodeTrailingIcon,null,a.default.createElement("span",{className:"icon-clickable delete",onClick:e=>{e.stopPropagation(),n({...l,currentCategory:r,isOpen:!0,type:"deleteCategory",headline:"Delete Category",message:"Delete category: "+r.categoryDisplayName})}},a.default.createElement(t.Icon,{name:"xp-minus-circle"}))))},T=({category:e,level:r})=>{const{dialogOptions:o,setDialog:n}=(0,a.useContext)(D),[l,c]=(0,a.useState)((e.children?.length??0)>0);return a.default.createElement(t.TreeNode,{nodeIdentifier:"categoryID",isDraggable:!1,isToggleable:(e.children?.length??0)>0,onNodeToggle:e=>c(e),isExpanded:l,renderNode:t=>a.default.createElement(b,{selected:t,category:e,setSelected:c}),level:r},e.children&&e.children.map((e=>a.default.createElement(T,{key:e.categoryID,category:e,level:r+1}))))},x=T,N=({categories:r})=>{const[o,n]=(0,a.useReducer)(I,{categories:r,dialogOptions:h}),{execute:l}=(0,e.usePageCommand)("SetCategory",{after:e=>{e&&n({type:"categorySet",data:e})}}),{execute:c}=(0,e.usePageCommand)("DeleteCategory",{after:e=>{e&&n({type:"categoryDelete",data:e})}}),i=(0,a.useMemo)((()=>{var e=o.categories;return e.forEach((t=>{t.children=e.filter((e=>e.categoryParentID===t.categoryID))})),e.filter((e=>!e.categoryParentID))}),[o]),s=e=>{n({type:"setDialog",data:e})};return a.default.createElement("div",null,a.default.createElement(t.Headline,{size:t.HeadlineSize.M},"Category List"),a.default.createElement(D.Provider,{value:{setCategory:l,deleteCategory:c,setCurrentCategory:e=>{n({type:"categorySelect",data:e})},dialogOptions:o.dialogOptions,setDialog:s,categories:o.categories}},a.default.createElement(t.TreeView,null,a.default.createElement(t.TreeNode,{nodeIdentifier:"categoryID",isDraggable:!1,isToggleable:!1,isExpanded:!0,renderNode:e=>a.default.createElement(a.default.Fragment,null,a.default.createElement(t.TreeNodeLeadingIcon,{isSelected:e,draggable:!1},a.default.createElement("span",{className:"icon-clickable add",onClick:e=>{e.stopPropagation(),s({...o.dialogOptions,currentCategory:{categoryDisplayName:""},isOpen:!0,type:"setCategory",headline:"Add Category",message:""})}},a.default.createElement(t.Icon,{name:"xp-plus-circle"}))),a.default.createElement(t.TreeNodeTitle,{isSelected:e},"Root Category")),level:0},i.map((e=>a.default.createElement(x,{key:e.categoryID,category:e,level:1}))))),a.default.createElement(E,null)))},k=(e,t)=>{const{type:a,data:r}=t,o={...e};switch(a){case"add-category":o.contentItemCategoryItems?.push({categoryID:r,contentItemID:o.contentItemID??-1}),o.contentItemCategoryItems&&(o.contentItemCategoryItems=[...o.contentItemCategoryItems]);break;case"remove-category":o.contentItemCategoryItems=o.contentItemCategoryItems?.filter((e=>e.categoryID!=r))}return o},S=(0,a.createContext)({categories:[]}),O=({categories:r,contentItemCategories:o,contentItemID:n})=>{const[l,c]=(0,a.useReducer)(k,{contentItemCategoryItems:o,contentItemID:n}),{execute:i}=(0,e.usePageCommand)("AddContentItemCategory",{after:e=>{e&&c({type:"add-category",data:e})}}),{execute:s}=(0,e.usePageCommand)("RemoveContentItemCategory",{after:e=>{e&&c({type:"remove-category",data:e})}}),d=(0,a.useMemo)((()=>{var e=r;return e.forEach((t=>{t.children=e.filter((e=>e.categoryParentID===t.categoryID))})),r.filter((e=>!e.categoryParentID))}),[r]);return a.default.createElement("div",{style:{padding:15}},a.default.createElement(t.Headline,{size:t.HeadlineSize.M},"Categories"),a.default.createElement("div",null,a.default.createElement(S.Provider,{value:{categories:r,addCategory:i,removeCategory:s,contentItemCategoryItems:l.contentItemCategoryItems}},a.default.createElement(t.TreeView,null,d.map((e=>a.default.createElement(w,{key:e.categoryID,category:e,level:1})))))))},P=O,w=({category:e,level:r})=>{const[o,n]=(0,a.useState)((e.children?.length??0)>0),{contentItemCategoryItems:l,addCategory:c,removeCategory:i}=(0,a.useContext)(S),s=(0,a.useMemo)((()=>l?.find((t=>t.categoryID==e.categoryID))),[e,l]);return a.default.createElement(t.TreeNode,{nodeIdentifier:"categoryID",isDraggable:!1,isToggleable:(e.children?.length??0)>0,onNodeToggle:e=>n(e),isSelectable:!0,isExpanded:o,renderNode:r=>a.default.createElement(a.default.Fragment,null,a.default.createElement(t.TreeNodeTitle,{isSelected:r},e.categoryDisplayName),s&&a.default.createElement(t.TreeNodeTrailingIcon,null,a.default.createElement("span",{style:{color:"green"}},a.default.createElement(t.Icon,{name:"xp-check-circle"})))),onNodeClick:()=>{s?i&&e.categoryID&&i(e.categoryID):c&&e.categoryID&&c(e.categoryID)},level:r},e.children&&e.children.map((e=>a.default.createElement(w,{key:e.categoryID,category:e,level:r+1}))))},M=(e,t)=>{const{type:a,data:r}=t,o={...e};switch(a){case"categories":o.categories=r;break;case"dialog-options":o.dialogOptions=r}return o},A=(0,a.createContext)({categories:[],selectedCategories:[]}),F=r=>{var[o,n]=(0,a.useReducer)(M,{categories:[],dialogOptions:{isOpen:!1,selectedCategories:[]}});const{executeCommand:l}=(0,e.useFormComponentCommandProvider)();(0,a.useEffect)((()=>{l(r,"GetCategories").then((e=>e&&n({type:"categories",data:e})))}),[]);const c=()=>{n({type:"dialog-options",data:{isOpen:!1,selectedCategories:[]}})},i=(0,a.useMemo)((()=>{var e=o.categories;return e.forEach((t=>{t.children=e.filter((e=>e.categoryParentID===t.categoryID))})),o.categories.filter((e=>!e.categoryParentID))}),[o.categories]);return a.default.createElement(t.FormItemWrapper,{label:r.label,explanationText:r.explanationText,invalid:r.invalid,validationMessage:r.validationMessage,markAsRequired:r.required,labelIcon:r.tooltip?"xp-i-circle":void 0,labelIconTooltip:r.tooltip,childrenWrapperClassnames:"category-list"},a.default.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"flex-start"}},r.value.map((e=>a.default.createElement(t.Button,{badge:!0,label:o.categories.find((t=>t.categoryID==e))?.categoryDisplayName,disabled:!0})))),a.default.createElement(t.Button,{label:"Select Categories",onClick:()=>{n({type:"dialog-options",data:{isOpen:!0,selectedCategories:r.value}})},color:t.ButtonColor.Primary}),o.dialogOptions.isOpen&&a.default.createElement(t.Dialog,{isOpen:o.dialogOptions.isOpen,headline:"Select Categories",isDismissable:!0,headerCloseButton:{tooltipText:"Close Dialog"},confirmAction:{label:"Done",onClick:()=>{r.onChange&&r.onChange(o.dialogOptions.selectedCategories),c()}},cancelAction:{label:"Cancel",onClick:c},onClose:c},a.default.createElement(A.Provider,{value:{categories:o.categories,selectedCategories:o.dialogOptions.selectedCategories,addCategory:e=>{var t=[...o.dialogOptions.selectedCategories];t.push(e),n({type:"dialog-options",data:{isOpen:!0,selectedCategories:t}})},removeCategory:e=>{var t=o.dialogOptions.selectedCategories.filter((t=>t!=e));n({type:"dialog-options",data:{isOpen:!0,selectedCategories:t}})}}},a.default.createElement(t.TreeView,null,a.default.createElement(t.TreeNode,{nodeIdentifier:"categoryID",isDraggable:!1,isToggleable:!1,isSelectable:!1,isExpanded:!0,renderNode:e=>a.default.createElement(a.default.Fragment,null,a.default.createElement(t.TreeNodeTitle,{isSelected:e},"Root Category")),level:0},i.map((e=>a.default.createElement(R,{key:e.categoryID,category:e,level:1}))))))))},R=({category:e,level:r})=>{const[o,n]=(0,a.useState)((e.children?.length??0)>0),{selectedCategories:l,addCategory:c,removeCategory:i}=(0,a.useContext)(A),s=(0,a.useMemo)((()=>l?.find((t=>t==e.categoryID))),[e,l]);return a.default.createElement(t.TreeNode,{nodeIdentifier:"categoryID",isDraggable:!1,isToggleable:(e.children?.length??0)>0,onNodeToggle:e=>n(e),isSelectable:!0,isExpanded:o,renderNode:r=>a.default.createElement(a.default.Fragment,null,a.default.createElement(t.TreeNodeTitle,{isSelected:r},e.categoryDisplayName),s&&a.default.createElement(t.TreeNodeTrailingIcon,null,a.default.createElement("span",{style:{color:"green"}},a.default.createElement(t.Icon,{name:"xp-check-circle"})))),onNodeClick:()=>{s?i&&e.categoryID&&i(e.categoryID):c&&e.categoryID&&c(e.categoryID)},level:r},e.children&&e.children.map((e=>a.default.createElement(R,{key:e.categoryID,category:e,level:r+1}))))}})(),c})())}}}));